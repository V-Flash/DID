$(function(){
  // Initialize Owl Carousel
  var owl = $(".owl-carousel").owlCarousel({
    items: 4,
    loop: true,
    autoWidth: true,
    autoplay: true,
    autoplayTimeout: 3000,
    autoplayHoverPause: true,
    onInitialized: updateCarousel,
    onResized: updateCarousel
  });

  // Function to update Owl Carousel
  function updateCarousel(event){
    var itemCount = owl.find('.owl-item:not(.cloned)').length;
    if(itemCount === 1){
      owl.trigger('to.owl.carousel', 0);
      owl.trigger('stop.owl.autoplay');
    }
  }

  // Event handler for filter click
  $(".filtering").on("click", "span", function () {
    var filter = $(this).attr("data-filter");

    // Update Owl Carousel items based on filter
    owl.owlCarousel('destroy');
    owl.empty();

    var filteredItems = $(".gallery").find(filter);
    filteredItems.each(function(){
      owl.append($(this).clone());
    });

    owl.owlCarousel({
      items: 4,
      loop: true,
      autoWidth: true,
      autoplay: true,
      autoplayTimeout: 3000,
      autoplayHoverPause: true,
      onInitialized: updateCarousel,
      onResized: updateCarousel
    });
  });
});
