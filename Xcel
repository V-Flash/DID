<script>
window.addEventListener('DOMContentLoaded', (event) => {
    var reader = new FileReader();

    reader.onload = function(event) {
        var data = new Uint8Array(event.target.result);
        var work_book = XLSX.read(data, { type: 'array' });
        var sheet_name = work_book.SheetNames;
        var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], { header: 1 });

        if (sheet_data.length > 0) {
            var table = $('#excel_table').DataTable({
                data: sheet_data,
                responsive: true,
                dom: 'Bfrtip', // Only show buttons without column visibility toggle
                buttons: [
                    'copy', 'csv', 'excel', 'pdf', 'print'
                ],
                columns: sheet_data[0].map(function(col, index) {
                    return { title: col };
                })
            });
        }
    };

    // Load your Excel file here
    var fileInput = 'yog-class.xlsx'; // Replace with the actual path to your file
    fetch(fileInput)
      .then(response => response.blob())
      .then(blob => reader.readAsArrayBuffer(blob));
});
</script>
