function smoothRotate(element, angle, duration) {
    const startAngle = parseFloat(element.style.transform.replace(/[^0-9\-.,]/g, ''));
    let startTime;

    function step(timestamp) {
        if (!startTime) startTime = timestamp;
        const progress = (timestamp - startTime) / duration;

        if (progress < 1) {
            const rotateValue = `rotate(${startAngle + angle * progress}deg)`;
            element.style.transform = rotateValue;
            requestAnimationFrame(step);
        } else {
            element.style.transform = `rotate(${startAngle + angle}deg)`;
        }
    }

    requestAnimationFrame(step);
}

$('body').on('click', '.nav-link-dropdown', function(e) {
    var $this = $(this);
    var $parentListItem = $this.closest('li');
    var $collapse = $parentListItem.find('.collapse');
    var $arrowCollapse = $('.site-mobile-menu .site-nav-wrap .arrow-collapse');

    if ($collapse.hasClass('show')) {
        $this.removeClass('active');
        $collapse.removeClass('show');
        smoothRotate($arrowCollapse[0], -180, 300); // Rotate 180 degrees in 300ms
    } else {
        $this.addClass('active');
        $collapse.addClass('show');
        smoothRotate($arrowCollapse[0], 180, 300); // Rotate 180 degrees in 300ms
    }

    e.preventDefault();
});
