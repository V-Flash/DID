var siteMenuClone = function() {
  $('.js-clone-nav').each(function() {
    var $this = $(this);
    $this.clone().attr('class', 'site-nav-wrap').appendTo('.site-mobile-menu-body');
  });

  $('body').on('click', '.nav-link-dropdown, .arrow-expand', function(e) {
    var $this = $(this);
    var $parentListItem = $this.closest('li');
    var $collapse = $parentListItem.find('.dropdown');
    var $arrowExpand = $parentListItem.find('.arrow-expand');

    // Check if the clicked element has children (nested dropdowns)
    var hasChildren = $parentListItem.find('.has-children').length > 0;

    if (hasChildren) {
      // If it has children, toggle visibility as before
      if ($collapse.is(':visible')) {
        $this.removeClass('active');
        $collapse.slideUp();
        $arrowExpand.css('transform', 'rotate(0deg)');
      } else {
        $this.addClass('active');
        $collapse.slideDown();
        $arrowExpand.css('transform', 'rotate(180deg)');
      }
      e.preventDefault(); // Prevent the default behavior for links with children
    }
  });
};

siteMenuClone();
