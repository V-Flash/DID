<div class="accordion style-2 margin-bottom-30">
    <?php
    $faqcatdata = getallfaqcat();
    $groupedData = [];

    // Group FAQ data by htitle
    foreach ($faqcatdata as $faqCategory) {
        if ($faqCategory["is_visible"] != 0) {
            $fcat = getallfaqanswerbycategoryfront($faqCategory["id"]);

            foreach ($fcat as $faqItem) {
                $htitle = $faqItem["htitle"];
                $groupedData[$htitle][] = [
                    'question' => $faqItem["title2"],
                    'answer' => $faqItem["title"],
                    'shortby' => $faqItem["shortby"]
                ];
            }
        }
    }

    // Output the grouped FAQ items
    foreach ($groupedData as $htitle => $faqItems) {
        ?>
        <h3 class="faq-title"><?php echo $htitle; ?></h3>
        <div class="accordion-item">
            <?php
            foreach ($faqItems as $index => $faqItem) {
                ?>
                <h2 class="a-title main active but3">Q<?php echo $index + 1; ?>. <?php echo $faqItem['question']; ?><span
                            class="plusminus4">-</span></h2>
                <div class="a-content content3">
                    <div class="wrapper pb20">
                        <?php echo 'Ans: ' . $faqItem['answer']; ?>
                    </div>
                </div>
                <?php
            }
            ?>
        </div>
        <?php
    }
    ?>
</div>
