function save_custom_product_weight($product_id) {
    $weight = isset($_POST['_weight']) ? wc_clean($_POST['_weight']) : '';
    $weight_unit = isset($_POST['_weight_unit']) ? wc_clean($_POST['_weight_unit']) : 'g';

    if ($weight_unit === 'kg') {
        $weight = $weight * 1000; // Convert to grams
    }

    update_post_meta($product_id, '_weight', $weight);
}
add_action('woocommerce_process_product_meta', 'save_custom_product_weight');
