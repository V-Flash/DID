add_filter('woocommerce_product_get_weight', 'convert_weight_and_change_unit', 10, 2);

function convert_weight_and_change_unit($weight, $product) {
    if ($weight >= 1000) {
        $weight = $weight / 1000; // Convert grams to kilograms
        set_transient('woocommerce_weight_unit', 'kg', 60); // Change weight unit to 'kg' for 60 seconds
    } else {
        set_transient('woocommerce_weight_unit', 'gm', 60); // Change weight unit to 'gm' for 60 seconds
    }
    return $weight;
}
